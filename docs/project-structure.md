# 📁 Структура проекта

Добро пожаловать в документацию по архитектуре AI Telegram Bot! 🏗️

## 🎯 Обзор проекта

AI Telegram Bot - это универсальный бот с искусственным интеллектом, который объединяет возможности чат-бота и генератора изображений. Проект построен на Python с использованием современных библиотек и API.

---

## 📂 Структура файлов

```
tbotik/
├── 📄 bot.py                               # Основной файл бота
├── ⚙️ config.py                            # Конфигурация и управление токенами
├── 📋 requirements.txt                     # Зависимости Python
├── 🔐 env.example                          # Пример файла окружения
├── 🚫 .gitignore                           # Исключения Git
├── 🖼️ images/                              # Папка для сохранения изображений
│   └── .gitkeep                           # Файл для сохранения папки в Git
├── 📚 docs/                                # Документация
│   └── 📄 README.md                        # Главная страница документации
└── 🖼️ моё_изображение.png                  # Временные файлы изображений (устаревшие)
```

---

## 🏗️ Архитектура

### Основные компоненты

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Telegram API  │    │   OpenRouter    │    │   NeuroImg      │
│   (Чат)         │    │   (ИИ ответы)   │    │   (Картинки)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │   bot.py        │
                    │   (Основная     │
                    │    логика)      │
                    └─────────────────┘
                                 │
                    ┌─────────────────┐
                    │   config.py     │
                    │   (Токены)      │
                    └─────────────────┘
```

---

## 📄 Описание файлов

### 🎯 Основные файлы

#### `bot.py` - Главный файл бота
**Назначение**: Основная логика и обработка сообщений

**Основные функции**:
- `задать_вопрос()` - взаимодействие с OpenRouter API
- `сгенерировать_изображение()` - генерация картинок через NeuroImg
- `скачать_и_отправить_картинку()` - обработка изображений
- `запустить_генерацию_картинки()` - управление процессом генерации

**Обработчики команд**:
- `@bot.message_handler(commands=['start'])` - приветствие
- `@bot.message_handler(commands=['help'])` - справка
- `@bot.message_handler(commands=['draw'])` - генерация картинок
- `@bot.message_handler(func=lambda message: True)` - обработка текста

#### `config.py` - Конфигурация
**Назначение**: Управление токенами и настройками

**Функции**:
- Загрузка переменных из `.env` файла
- Проверка корректности токенов
- Fallback на значения по умолчанию

**Переменные**:
- `TELEGRAM_BOT_TOKEN` - токен Telegram бота
- `OPENROUTER_API_KEY` - ключ для ИИ API
- `NEUROIMG_API_KEY` - ключ для генерации изображений

#### `requirements.txt` - Зависимости
**Назначение**: Список Python пакетов

**Основные библиотеки**:
- `pyTelegramBotAPI` - работа с Telegram API
- `aiohttp` - асинхронные HTTP запросы
- `requests` - HTTP клиент
- `python-dotenv` - работа с .env файлами

#### `images/` - Папка изображений
**Назначение**: Хранение сгенерированных изображений

**Особенности**:
- Автоматическое создание уникальных имен файлов с временными метками
- Формат имен: `generated_image_YYYYMMDD_HHMMSS.png`
- Исключена из Git через `.gitignore` (кроме `.gitkeep`)
- Сохранение для последующего использования и анализа

**Примеры файлов**:
```
images/
├── .gitkeep                              # Сохраняет папку в Git
├── generated_image_20241201_143022.png   # Изображение от 1 декабря 14:30:22
├── generated_image_20241201_143156.png   # Изображение от 1 декабря 14:31:56
└── generated_image_20241201_143245.png   # Изображение от 1 декабря 14:32:45
```

### 📚 Документация

#### `docs/README.md` - Главная страница
- Обзор проекта
- Навигация по документации
- Быстрый старт

#### `docs/installation-beginner.md` - Установка для новичков
- Пошаговое руководство
- Простые объяснения
- Решение типичных проблем

#### `docs/user-guide.md` - Руководство пользователя
- Описание функций
- Примеры использования
- Советы и рекомендации

---

## 🔄 Поток данных

### 1. Обработка текстовых сообщений
```
Пользователь → Telegram → bot.py → OpenRouter API → Ответ → Пользователь
```

### 2. Генерация изображений
```
Пользователь → Telegram → bot.py → NeuroImg API → Скачивание → Пользователь
```

### 3. Обработка команд
```
Пользователь → Telegram → bot.py → Внутренняя логика → Ответ → Пользователь
```

---

## 🛠️ Технологический стек

### Основные технологии
- **Python 3.8+** - основной язык программирования
- **pyTelegramBotAPI** - библиотека для Telegram ботов
- **aiohttp** - асинхронные HTTP запросы
- **requests** - синхронные HTTP запросы
- **python-dotenv** - управление переменными окружения

### Внешние API
- **Telegram Bot API** - платформа для ботов
- **OpenRouter API** - доступ к различным ИИ моделям
- **NeuroImg API** - генерация изображений

### Архитектурные паттерны
- **Модульная архитектура** - разделение на логические компоненты
- **Асинхронное программирование** - для генерации изображений
- **Конфигурация через переменные окружения** - безопасность токенов
- **Обработка ошибок** - надежность и отказоустойчивость

---

## 🔒 Безопасность

### Управление токенами
- Токены хранятся в `.env` файле (не в коде)
- Файл `.env` исключен из Git через `.gitignore`
- Пример структуры в `env.example`

### Валидация данных
- Проверка длины описаний
- Валидация HTTP ответов
- Обработка исключений

### Ограничения
- Минимальная длина описания для картинок
- Проверка статусов API ответов
- Таймауты для запросов

---

## 🚀 Масштабируемость

### Возможности расширения
- Добавление новых команд
- Интеграция с другими API
- Поддержка новых форматов данных
- Многоязычность

### Оптимизация
- Асинхронная обработка изображений
- Кэширование ответов
- Логирование для отладки
- Мониторинг производительности

---

## 📊 Мониторинг и логирование

### Логирование
- Статус запуска бота
- Ошибки API запросов
- Время генерации изображений
- Статистика использования

### Отладка
- Подробные сообщения об ошибках
- Информация о статусе API
- Трассировка выполнения команд

---

## 🔄 Версионирование

### Структура версий
- **Семантическое версионирование** (MAJOR.MINOR.PATCH)
- **Changelog** в документации
- **Теги** в Git репозитории

### Совместимость
- Обратная совместимость API
- Миграция конфигурации
- Обновление зависимостей

---

## 📞 Поддержка и развитие

### Документация
- Подробные руководства
- Примеры использования
- Техническая документация
- FAQ и решения проблем

### Сообщество
- Issues в репозитории
- Pull requests
- Обсуждения функций
- Обратная связь пользователей

---

**Версия документации**: 1.0.0  
**Последнее обновление**: 2024  
**Автор**: AI Assistant 